{% extends "base.html" %}
{% block title %}Card History{% endblock %}

{% block content %}
  <h1 class="mb-4 text-center page-title">Recently Added Cards</h1>

  <!-- Filters -->
  <form method="get" class="row mb-4">
    <div class="col-md-3">
      <select name="rarity" class="form-select">
        <option value="all" {% if rarity_filter == "all" or not rarity_filter %}selected{% endif %}>All Rarities</option>
        <option value="common" {% if rarity_filter == "common" %}selected{% endif %}>Common</option>
        <option value="rare" {% if rarity_filter == "rare" %}selected{% endif %}>Rare</option>
        <option value="epic" {% if rarity_filter == "epic" %}selected{% endif %}>Epic</option>
        <option value="legendary" {% if rarity_filter == "legendary" %}selected{% endif %}>Legendary</option>
      </select>
    </div>
    <div class="col-md-5">
      <input type="text" name="search" class="form-control" placeholder="Search by base name" value="{{ search or '' }}">
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-primary">Filter</button>
    </div>
  </form>

  {% for c in cards %}
    <div class="card-row row" style="animation-delay: {{ loop.index0 * 0.1 }}s">
      <div class="col-md-3">
        <img src="{{ c.image_url }}" alt="{{ c.name }}">
      </div>
      <div class="col-md-7">
        <h5>
          <span class="id-badge">#{{ c.id }}</span>
          {{ c.name }}
          <small class="text-muted">({{ c.rarity|capitalize }}, ‚≠ê{{ c.potential }})</small>
        </h5>
        <p>{{ c.description }}</p>
        <small>Added: {{ c.created_at }}</small>
      </div>
      <div class="col-md-2 text-end">
        <a href="{{ url_for('edit_card', card_id=c.id) }}" class="btn btn-sm btn-warning">Edit</a>
      </div>
    </div>
  {% else %}
    <p>No cards found.</p>
  {% endfor %}
{% endblock %}
