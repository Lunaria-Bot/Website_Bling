{% extends "base.html" %}
{% block title %}Card History{% endblock %}

{% block head %}
<style>
  .card-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }
  .card-row {
    display: flex;
    flex-wrap: wrap;
    background-color: #1f2126;
    border: 1px solid #2c2f33;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .card-row:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.5);
  }
  .card-row img {
    width: 100%;
    height: 220px;
    object-fit: contain;
    background-color: #111;
    border-radius: 10px 0 0 10px;
  }
  .card-content {
    flex: 1;
    padding: 1rem 1.25rem;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .card-content h5 {
    margin: 0;
    font-weight: 600;
    font-size: 1.1rem;
  }
  .card-content p {
    margin: 0.5rem 0;
    font-size: 0.9rem;
    color: #ccc;
  }
  .card-content small {
    color: #888;
  }
  .id-badge {
    background-color: #444;
    color: #fff;
    font-size: 0.75rem;
    padding: 0.2rem 0.5rem;
    border-radius: 6px;
    margin-right: 0.5rem;
  }
  .card-actions {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding: 1rem;
  }
</style>
{% endblock %}

{% block content %}
  <h1 class="page-title">Card History</h1>

  <!-- Filters -->
  <form method="get" class="row mb-4 g-2 glass-card">
    <div class="col-md-3">
      <select name="form" class="form-select">
        <option value="all" {% if form_filter == "all" or not form_filter %}selected{% endif %}>All Forms</option>
        <option value="base" {% if form_filter == "base" %}selected{% endif %}>Base</option>
        <option value="awakened" {% if form_filter == "awakened" %}selected{% endif %}>Awakened</option>
        <option value="event" {% if form_filter == "event" %}selected{% endif %}>Event</option>
      </select>
    </div>
    <div class="col-md-5">
      <input type="text" name="search" class="form-control" placeholder="Search by character name" value="{{ search or '' }}">
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-primary w-100">Filter</button>
    </div>
  </form>

  <div class="card-list">
    {% for c in cards %}
      <div class="card-row">
        <div class="col-md-3 p-0">
          <img src="{{ c.image_url }}" alt="{{ c.character_name }}">
        </div>
        <div class="col-md-7 card-content">
          <h5>
            <span class="id-badge">#{{ c.id }}</span>
            {{ c.character_name }}
            <span class="text-muted">({{ c.form|capitalize }})</span>
          </h5>
          <p>{{ c.description }}</p>
          <small>Added: {{ c.created_at }}</small>
        </div>
        <div class="col-md-2 card-actions">
          <a href="{{ url_for('edit_card', card_id=c.id) }}" class="btn btn-sm btn-primary">Edit</a>
        </div>
      </div>
    {% else %}
      <p class="text-muted">No cards found.</p>
    {% endfor %}
  </div>
{% endblock %}
