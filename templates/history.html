{% extends "base.html" %}
{% block title %}Card History{% endblock %}

{% block head %}
<style>
  .card-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }
  .card-row {
    display: flex;
    flex-wrap: wrap;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    backdrop-filter: blur(10px);
    box-shadow: 0 0 12px rgba(0, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .card-row:hover {
    transform: translateY(-3px);
    box-shadow: 0 0 20px rgba(255, 0, 255, 0.3);
  }
  .card-row img {
    width: 100%;
    height: 220px;
    object-fit: contain;
    background: #111;
    border-radius: 12px 0 0 12px;
  }
  .card-content {
    flex: 1;
    padding: 1rem 1.25rem;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .card-content h5 {
    margin: 0;
    font-weight: 600;
    font-size: 1.1rem;
  }
  .card-content p {
    margin: 0.5rem 0;
    font-size: 0.9rem;
    color: #ccc;
  }
  .card-content small {
    color: #888;
  }
  .id-badge {
    background: #444;
    color: #fff;
    font-size: 0.75rem;
    padding: 0.2rem 0.5rem;
    border-radius: 6px;
    margin-right: 0.5rem;
  }
  .card-actions {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding: 1rem;
  }
</style>
{% endblock %}

{% block content %}
  <h1 class="mb-4 text-center glow-title">ðŸ“œ Recently Added Cards</h1>

  <!-- Filters -->
  <form method="get" class="row mb-4 g-2 glass-card">
    <div class="col-md-3">
      <select name="form" class="form-select">
        <option value="all" {% if form_filter == "all" or not form_filter %}selected{% endif %}>All Forms</option>
        <option value="base" {% if form_filter == "base" %}selected{% endif %}>ðŸŸ¦ Base</option>
        <option value="awakened" {% if form_filter == "awakened" %}selected{% endif %}>âœ¨ Awakened</option>
        <option value="event" {% if form_filter == "event" %}selected{% endif %}>ðŸŽ‰ Event</option>
      </select>
    </div>
    <div class="col-md-5">
      <input type="text" name="search" class="form-control" placeholder="Search by character name" value="{{ search or '' }}">
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-glow w-100">Filter</button>
    </div>
  </form>

  <div class="card-list">
    {% for c in cards %}
      <div class="card-row">
        <div class="col-md-3 p-0">
          <img src="{{ c.image_url }}" alt="{{ c.character_name }}">
        </div>
        <div class="col-md-7 card-content">
          <h5>
            <span class="id-badge">#{{ c.id }}</span>
            {{ c.character_name }}
            {% if c.form == "base" %}
              <span class="badge badge-form badge-base">ðŸŸ¦ Base</span>
            {% elif c.form == "awakened" %}
              <span class="badge badge-form badge-awakened">âœ¨ Awakened</span>
            {% elif c.form == "event" %}
              <span class="badge badge-form badge-event">ðŸŽ‰ Event</span>
            {% endif %}
          </h5>
          <p>{{ c.description }}</p>
          <small>Added: {{ c.created_at }}</small>
        </div>
        <div class="col-md-2 card-actions">
          <a href="{{ url_for('edit_card', card_id=c.id) }}" class="btn btn-sm btn-glow">Edit</a>
        </div>
      </div>
    {% else %}
      <p class="text-center text-muted">No cards found.</p>
    {% endfor %}
  </div>
{% endblock %}
