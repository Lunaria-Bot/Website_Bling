{% extends "base.html" %}
{% block title %}Upload Image{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-3" data-aos="fade-right">
    <div class="glass-card p-3">
      <h5 class="text-light mb-4">Navigation</h5>
      <ul class="nav flex-column">
        <li class="nav-item mb-2">
          <a class="nav-link text-light" href="{{ url_for('admin_dashboard') }}">
            <i class="fas fa-chart-pie me-2"></i> Dashboard
          </a>
        </li>
        <li class="nav-item mb-2">
          <a class="nav-link text-light fw-bold text-primary" href="{{ url_for('upload_image') }}">
            <i class="fas fa-upload me-2"></i> Upload Image
          </a>
        </li>
      </ul>
    </div>
  </div>

  <div class="col-md-9">
    <h1 class="page-title" data-aos="fade-down">Upload Card Image</h1>

    <form method="POST" action="{{ url_for('upload_image') }}" enctype="multipart/form-data">
      <div class="glass-card p-4" data-aos="fade-up">
        <div class="mb-3">
          <label for="custom_name" class="form-label text-light">Custom Filename (optional)</label>
          <input type="text" class="form-control bg-dark text-light border-secondary" id="custom_name" name="custom_name" placeholder="e.g. GOJO_SATORU">
        </div>

        <div class="mb-3">
          <label for="image_file" class="form-label text-light">Select Image</label>
          <input type="file" class="form-control bg-dark text-light border-secondary" id="image_file" name="image_file" accept="image/*" required>
        </div>

        <div class="text-end">
          <button type="submit" class="btn btn-primary px-4">Upload</button>
        </div>
      </div>
    </form>

    {% if uploaded_url %}
    <div class="glass-card mt-4 p-3 text-center" data-aos="fade-up" data-aos-delay="300">
      <h5 class="text-success">✅ Image Uploaded</h5>
      <img src="{{ uploaded_url }}" class="img-fluid rounded mb-3" style="max-height: 300px;">
      <p class="text-light">URL to use in bot:</p>
      <code class="text-info">{{ uploaded_url }}</code>
    </div>
    {% endif %}

    <hr class="my-5">

    <h2 class="text-light" data-aos="fade-down">🔍 Search Uploaded Images</h2>
    <form method="POST" action="{{ url_for('upload_image') }}">
      <div class="glass-card p-4" data-aos="fade-up">
        <div class="mb-3">
          <input type="text" class="form-control bg-dark text-light border-secondary" name="search_query" placeholder="Search by filename..." required>
        </div>
        <div class="text-end">
          <button type="submit" class="btn btn-secondary px-4">Search</button>
        </div>
      </div>
    </form>

    {% if search_results %}
    <div class="glass-card mt-4 p-3" data-aos="fade-up" data-aos-delay="300">
      <h5 class="text-info">🔎 Results</h5>
      <ul class="list-group list-group-flush">
        {% for file in search_results %}
        <li class="list-group-item bg-dark text-light">
          <a href="{{ url_for('static', filename='uploads/' ~ file) }}" target="_blank">{{ file }}</a>
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
